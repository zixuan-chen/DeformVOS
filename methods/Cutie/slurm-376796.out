
CommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.


cuda-11.8 loaded successful
Failed to import hickle. Fine if not using multi-scale testing.
[2024-07-02 20:42:45][INFO] - All configuration: {'exp_id': 'base1080p', 'dataset': 'vost-val', 'amp': False, 'weights': 'output/cutie-base-mega.pth', 'output_dir': None, 'flip_aug': False, 'gpu': 0, 'max_internal_size': -1, 'image_directory': None, 'mask_directory': None, 'json_directory': None, 'size': -1, 'save_all': None, 'use_all_masks': None, 'use_long_term': None, 'mem_every': None, 'max_mem_frames': 5, 'long_term': {'count_usage': True, 'max_mem_frames': 10, 'min_mem_frames': 5, 'num_prototypes': 128, 'max_num_tokens': 10000, 'buffer_tokens': 2000}, 'top_k': 30, 'stagger_updates': 5, 'chunk_size': -1, 'save_scores': False, 'save_aux': False, 'visualize': False, 'datasets': {'d16-val': {'image_directory': '../DAVIS/2016/JPEGImages/480p', 'mask_directory': '../DAVIS/2016/Annotations/480p', 'subset': '../DAVIS/2017/trainval/ImageSets/2016/val.txt', 'size': 480, 'save_all': True, 'use_all_masks': False, 'use_long_term': False, 'mem_every': 5}, 'd17-val': {'image_directory': '../DAVIS/2017/trainval/JPEGImages/480p', 'mask_directory': '../DAVIS/2017/trainval/Annotations/480p', 'subset': '../DAVIS/2017/trainval/ImageSets/2017/val.txt', 'size': 480, 'save_all': True, 'use_all_masks': False, 'use_long_term': False, 'mem_every': 5}, 'd17-test-dev': {'image_directory': '../DAVIS/2017/test-dev/JPEGImages/480p', 'mask_directory': '../DAVIS/2017/test-dev/Annotations/480p', 'subset': '../DAVIS/2017/test-dev/ImageSets/2017/test-dev.txt', 'size': 480, 'save_all': True, 'use_all_masks': False, 'use_long_term': False, 'mem_every': 5}, 'y18-val': {'image_directory': '../YouTube2018/all_frames/valid_all_frames/JPEGImages', 'mask_directory': '../YouTube2018/valid/Annotations', 'json_directory': '../YouTube2018/valid/meta.json', 'size': 480, 'save_all': False, 'use_all_masks': True, 'use_long_term': False, 'mem_every': 5}, 'y19-val': {'image_directory': '../YouTube/all_frames/valid_all_frames/JPEGImages', 'mask_directory': '../YouTube/valid/Annotations', 'json_directory': '../YouTube/valid/meta.json', 'size': 480, 'save_all': False, 'use_all_masks': True, 'use_long_term': False, 'mem_every': 5}, 'mose-val': {'image_directory': '../MOSE/valid/JPEGImages', 'mask_directory': '../MOSE/valid/Annotations', 'size': 480, 'save_all': True, 'use_all_masks': False, 'use_long_term': False, 'mem_every': 5}, 'generic': {'image_directory': None, 'mask_directory': None, 'size': -1, 'save_all': True, 'use_all_masks': False, 'use_long_term': True, 'mem_every': 5}, 'burst-val': {'skip_frames': -1, 'image_directory': '../BURST/frames/val', 'json_directory': '../BURST/val/first_frame_annotations.json', 'size': 600, 'save_all': False, 'use_long_term': True, 'mem_every': 10}, 'burst-test': {'skip_frames': -1, 'image_directory': '../BURST/frames/test', 'json_directory': '../BURST/test/first_frame_annotations.json', 'size': 600, 'save_all': False, 'use_long_term': True, 'mem_every': 10}, 'lvos-val': {'image_directory': '../LVOS/valid/JPEGImages', 'mask_directory': '../LVOS/valid/Annotations_first_only', 'size': 480, 'save_all': False, 'use_all_masks': True, 'use_long_term': True, 'mem_every': 5}, 'lvos-test': {'image_directory': '../LVOS/test/JPEGImages', 'mask_directory': '../LVOS/test/Annotations', 'size': 480, 'save_all': False, 'use_all_masks': True, 'use_long_term': True, 'mem_every': 5}, 'vost-val': {'image_directory': '/home/bingxing2/home/scx7kwl/dataset/VOST/JPEGImages', 'mask_directory': '/home/bingxing2/home/scx7kwl/dataset/VOST/Annotations', 'subset': '/home/bingxing2/home/scx7kwl/dataset/VOST/ImageSets/val.txt', 'size': -1, 'save_all': True, 'use_all_masks': False, 'use_long_term': False, 'mem_every': 5}}, 'model': {'pixel_mean': [0.485, 0.456, 0.406], 'pixel_std': [0.229, 0.224, 0.225], 'pixel_dim': 256, 'key_dim': 64, 'value_dim': 256, 'sensory_dim': 256, 'embed_dim': 256, 'pixel_encoder': {'type': 'resnet50', 'ms_dims': [1024, 512, 256]}, 'mask_encoder': {'type': 'resnet18', 'final_dim': 256}, 'pixel_pe_scale': 32, 'pixel_pe_temperature': 128, 'object_transformer': {'embed_dim': '${model.embed_dim}', 'ff_dim': 2048, 'num_heads': 8, 'num_blocks': 3, 'num_queries': 16, 'read_from_pixel': {'input_norm': False, 'input_add_pe': False, 'add_pe_to_qkv': [True, True, False]}, 'read_from_past': {'add_pe_to_qkv': [True, True, False]}, 'read_from_memory': {'add_pe_to_qkv': [True, True, False]}, 'read_from_query': {'add_pe_to_qkv': [True, True, False], 'output_norm': False}, 'query_self_attention': {'add_pe_to_qkv': [True, True, False]}, 'pixel_self_attention': {'add_pe_to_qkv': [True, True, False]}}, 'object_summarizer': {'embed_dim': '${model.object_transformer.embed_dim}', 'num_summaries': '${model.object_transformer.num_queries}', 'add_pe': True}, 'aux_loss': {'sensory': {'enabled': True, 'weight': 0.01}, 'query': {'enabled': True, 'weight': 0.01}}, 'mask_decoder': {'up_dims': [256, 128, 128]}}}
[2024-07-02 20:42:45][INFO] - Single object: False
[2024-07-02 20:42:50][INFO] - Overriding config size from -1 to -1
  0%|          | 0/70 [00:00<?, ?it/s]10625_knead_dough:   0%|          | 0/70 [00:00<?, ?it/s]10625_knead_dough:   1%|▏         | 1/70 [00:15<18:21, 15.96s/it]1169_peel_onion:   1%|▏         | 1/70 [00:16<18:21, 15.96s/it]  1169_peel_onion:   3%|▎         | 2/70 [00:25<14:01, 12.37s/it]1179_cut_onion:   3%|▎         | 2/70 [00:25<14:01, 12.37s/it] 1179_cut_onion:   4%|▍         | 3/70 [00:39<14:37, 13.09s/it]1184_cut_chilli:   4%|▍         | 3/70 [00:39<14:37, 13.09s/it]1184_cut_chilli:   6%|▌         | 4/70 [00:54<15:11, 13.81s/it]1186_cut_chilli:   6%|▌         | 4/70 [00:54<15:11, 13.81s/it]1186_cut_chilli:   7%|▋         | 5/70 [01:18<18:59, 17.53s/it]1188_cut_ladyfinger:   7%|▋         | 5/70 [01:18<18:59, 17.53s/it]1188_cut_ladyfinger:   9%|▊         | 6/70 [01:26<15:06, 14.17s/it]1192_cut_ladyfinger:   9%|▊         | 6/70 [01:26<15:06, 14.17s/it]1192_cut_ladyfinger:  10%|█         | 7/70 [01:38<14:07, 13.45s/it]1200_cut_onion:  10%|█         | 7/70 [01:38<14:07, 13.45s/it]     1200_cut_onion:  11%|█▏        | 8/70 [01:44<11:30, 11.14s/it]1201_cut_chili:  11%|█▏        | 8/70 [01:44<11:30, 11.14s/it]1201_cut_chili:  13%|█▎        | 9/70 [01:56<11:38, 11.46s/it]1202_cut_chili:  13%|█▎        | 9/70 [01:56<11:38, 11.46s/it]1202_cut_chili:  14%|█▍        | 10/70 [02:10<12:15, 12.26s/it]1203_cut_mango:  14%|█▍        | 10/70 [02:10<12:15, 12.26s/it]1203_cut_mango:  16%|█▌        | 11/70 [02:38<16:49, 17.11s/it]1205_cut_mango:  16%|█▌        | 11/70 [02:38<16:49, 17.11s/it]1205_cut_mango:  17%|█▋        | 12/70 [02:47<13:59, 14.48s/it]1206_cut_mango:  17%|█▋        | 12/70 [02:47<13:59, 14.48s/it]1206_cut_mango:  19%|█▊        | 13/70 [02:58<12:46, 13.45s/it]1207_break_garlic:  19%|█▊        | 13/70 [02:58<12:46, 13.45s/it]1207_break_garlic:  20%|██        | 14/70 [03:11<12:21, 13.24s/it]1210_cut_garlic:  20%|██        | 14/70 [03:11<12:21, 13.24s/it]  1210_cut_garlic:  21%|██▏       | 15/70 [03:16<10:04, 10.99s/it]1211_cut_garlic:  21%|██▏       | 15/70 [03:17<10:04, 10.99s/it]1211_cut_garlic:  23%|██▎       | 16/70 [03:26<09:30, 10.56s/it]3161_peel_banana:  23%|██▎       | 16/70 [03:26<09:30, 10.56s/it]3161_peel_banana:  24%|██▍       | 17/70 [03:34<08:34,  9.71s/it]3316_peel_onion:  24%|██▍       | 17/70 [03:34<08:34,  9.71s/it] 3316_peel_onion:  26%|██▌       | 18/70 [03:44<08:29,  9.80s/it]3317_peel_onion:  26%|██▌       | 18/70 [03:44<08:29,  9.80s/it]3317_peel_onion:  27%|██▋       | 19/70 [03:58<09:26, 11.10s/it]3510_unscrew_bottle:  27%|██▋       | 19/70 [03:58<09:26, 11.10s/it]3510_unscrew_bottle:  29%|██▊       | 20/70 [04:04<08:02,  9.65s/it]3511_unscrew_jar:  29%|██▊       | 20/70 [04:04<08:02,  9.65s/it]   3511_unscrew_jar:  30%|███       | 21/70 [04:15<08:12, 10.05s/it]3559_break_egg:  30%|███       | 21/70 [04:15<08:12, 10.05s/it]  3559_break_egg:  31%|███▏      | 22/70 [04:39<11:27, 14.32s/it]3562_break_egg:  31%|███▏      | 22/70 [04:39<11:27, 14.32s/it]3562_break_egg:  33%|███▎      | 23/70 [04:46<09:28, 12.09s/it]3563_break_egg:  33%|███▎      | 23/70 [04:46<09:28, 12.09s/it]3563_break_egg:  34%|███▍      | 24/70 [04:58<09:08, 11.92s/it]3993_cut_tomato:  34%|███▍      | 24/70 [04:58<09:08, 11.92s/it]3993_cut_tomato:  36%|███▌      | 25/70 [05:05<07:50, 10.45s/it]4014_cut_tomato:  36%|███▌      | 25/70 [05:05<07:50, 10.45s/it]4014_cut_tomato:  37%|███▋      | 26/70 [05:09<06:13,  8.48s/it]4016_cut_herbs:  37%|███▋      | 26/70 [05:09<06:13,  8.48s/it] 4016_cut_herbs:  39%|███▊      | 27/70 [05:15<05:38,  7.87s/it]4021_cut_broccoli:  39%|███▊      | 27/70 [05:15<05:38,  7.87s/it]4021_cut_broccoli:  40%|████      | 28/70 [05:35<08:04, 11.54s/it]4030_cut_broccoli:  40%|████      | 28/70 [05:35<08:04, 11.54s/it]4030_cut_broccoli:  41%|████▏     | 29/70 [06:16<13:47, 20.19s/it]4031_cut_broccoli:  41%|████▏     | 29/70 [06:16<13:47, 20.19s/it]4031_cut_broccoli:  43%|████▎     | 30/70 [06:47<15:39, 23.50s/it]4222_peel_wire:  43%|████▎     | 30/70 [06:47<15:39, 23.50s/it]   4222_peel_wire:  44%|████▍     | 31/70 [06:55<12:10, 18.73s/it]4340_roll_dough:  44%|████▍     | 31/70 [06:55<12:10, 18.73s/it]4340_roll_dough:  46%|████▌     | 32/70 [07:09<11:00, 17.38s/it]4357_trim_dough:  46%|████▌     | 32/70 [07:09<11:00, 17.38s/it]4357_trim_dough:  47%|████▋     | 33/70 [07:15<08:41, 14.09s/it]4624_cut_paper:  47%|████▋     | 33/70 [07:15<08:41, 14.09s/it] 4624_cut_paper:  49%|████▊     | 34/70 [07:24<07:29, 12.48s/it]4626_cut_paper:  49%|████▊     | 34/70 [07:24<07:29, 12.48s/it]4626_cut_paper:  50%|█████     | 35/70 [07:34<06:47, 11.66s/it]4632_cut_paper:  50%|█████     | 35/70 [07:34<06:47, 11.66s/it]4632_cut_paper:  51%|█████▏    | 36/70 [07:38<05:26,  9.60s/it]5013_peel_onion:  51%|█████▏    | 36/70 [07:38<05:26,  9.60s/it]5013_peel_onion:  53%|█████▎    | 37/70 [08:11<09:04, 16.51s/it]5110_paint_nail:  53%|█████▎    | 37/70 [08:11<09:04, 16.51s/it]5110_paint_nail:  54%|█████▍    | 38/70 [08:37<10:19, 19.36s/it]5118_squeeze_bag:  54%|█████▍    | 38/70 [08:37<10:19, 19.36s/it]5118_squeeze_bag:  56%|█████▌    | 39/70 [08:47<08:30, 16.45s/it]5182_open_box:  56%|█████▌    | 39/70 [08:47<08:30, 16.45s/it]   5182_open_box:  57%|█████▋    | 40/70 [08:55<07:04, 14.15s/it]5253_open_package:  57%|█████▋    | 40/70 [08:56<07:04, 14.15s/it][2024-07-02 20:51:54][ERROR] - Runtime error at 5253_open_package
[2024-07-02 20:51:54][ERROR] - CUDA out of memory. Tried to allocate 6.87 GiB. GPU 
5253_open_package:  57%|█████▋    | 40/70 [09:03<06:47, 13.59s/it]
Error executing job with overrides: ['dataset=vost-val', 'size=-1', 'weights=output/cutie-base-mega.pth', 'model=base', 'exp_id=base1080p', 'gpu=0']
Traceback (most recent call last):
  File "cutie/eval_vos.py", line 166, in eval_vos
    raise e
  File "cutie/eval_vos.py", line 143, in eval_vos
    prob = processor.step(image, mask, valid_labels, end=(ti == vid_length - 1))
  File "/home/bingxing2/home/scx7kwl/zixuan/DeformVOS/methods/Cutie/./cutie/inference/inference_core.py", line 252, in step
    pred_prob_with_bg = self._segment(key,
  File "/home/bingxing2/home/scx7kwl/zixuan/DeformVOS/methods/Cutie/./cutie/inference/inference_core.py", line 153, in _segment
    memory_readout = self.memory.read(pix_feat, key, selection, self.last_mask, self.network)
  File "/home/bingxing2/home/scx7kwl/zixuan/DeformVOS/methods/Cutie/./cutie/inference/memory_manager.py", line 162, in read
    similarity = get_similarity(memory_key, shrinkage, query_key, selection)
  File "/home/bingxing2/home/scx7kwl/zixuan/DeformVOS/methods/Cutie/./cutie/model/utils/memory_utils.py", line 42, in get_similarity
    similarity = similarity * ms / math.sqrt(CK)  # B*N*HW
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 6.87 GiB. GPU 

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
